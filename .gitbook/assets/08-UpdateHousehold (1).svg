<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="919px" preserveAspectRatio="none" style="width:1282px;height:919px;background:#FFFFFF;" version="1.1" viewBox="0 0 1282 919" width="1282px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="157" x="564.25" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="147" x="569.25" y="27.9951">Update Household</text><rect fill="#FFFFFF" height="761.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="344.5" y="104.7266"/><rect fill="none" height="431.7266" style="stroke:#000000;stroke-width:1.5;" width="1011" x="265.5" y="176.9922"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="33" x2="33" y1="73.5938" y2="883.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="349.5" x2="349.5" y1="73.5938" y2="883.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="614" x2="614" y1="73.5938" y2="883.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="841" x2="841" y1="73.5938" y2="883.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1149.5" x2="1149.5" y1="73.5938" y2="883.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1232.5" x2="1232.5" y1="73.5938" y2="883.7813"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="12" y="62.292">Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="5" y="882.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="12" y="902.7764">Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148" x="275.5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="282.5" y="62.292">HouseholdRegistry</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148" x="275.5" y="882.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="282.5" y="902.7764">HouseholdRegistry</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="544" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="551" y="62.292">IndividualRegistry</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="544" y="882.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="551" y="902.7764">IndividualRegistry</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="814" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="821" y="62.292">Kafka</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="814" y="882.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="821" y="902.7764">Kafka</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="1110.5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1117.5" y="62.292">Persister</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="1110.5" y="882.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1117.5" y="902.7764">Persister</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="1198.5" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1205.5" y="62.292">Indexer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="1198.5" y="882.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1205.5" y="902.7764">Indexer</text><rect fill="#FFFFFF" height="761.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="344.5" y="104.7266"/><polygon fill="#181818" points="332.5,100.7266,342.5,104.7266,332.5,108.7266,336.5,104.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="33.5" x2="338.5" y1="104.7266" y2="104.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="40.5" y="99.6606">Update Household</text><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="396.5" y1="148.9922" y2="148.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="396.5" y1="148.9922" y2="161.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="396.5" y1="161.9922" y2="161.9922"/><polygon fill="#181818" points="365.5,157.9922,355.5,161.9922,365.5,165.9922,361.5,161.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="361.5" y="128.7935">Validate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="361.5" y="143.9263">Request</text><path d="M265.5,176.9922 L337.5,176.9922 L337.5,184.125 L327.5,194.125 L265.5,194.125 L265.5,176.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="431.7266" style="stroke:#000000;stroke-width:1.5;" width="1011" x="265.5" y="176.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="280.5" y="190.0591">opt</text><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="396.5" y1="215.2578" y2="215.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="396.5" y1="215.2578" y2="228.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="396.5" y1="228.2578" y2="228.2578"/><polygon fill="#181818" points="365.5,224.2578,355.5,228.2578,365.5,232.2578,361.5,228.2578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="361.5" y="210.1919">Individual data changed?</text><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="396.5" y1="257.3906" y2="257.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="396.5" y1="257.3906" y2="270.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="396.5" y1="270.3906" y2="270.3906"/><polygon fill="#181818" points="365.5,266.3906,355.5,270.3906,365.5,274.3906,361.5,270.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="361.5" y="252.3247">Fetch individual(s) to update</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="354.5" y1="299.5234" y2="299.5234"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="312.5" y1="299.5234" y2="312.5234"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="353.5" y1="312.5234" y2="312.5234"/><polygon fill="#181818" points="345.5,308.5234,355.5,312.5234,345.5,316.5234,349.5,312.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="277.5" y="294.4575">Individual(s)</text><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="396.5" y1="341.6563" y2="341.6563"/><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="396.5" y1="341.6563" y2="354.6563"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="396.5" y1="354.6563" y2="354.6563"/><polygon fill="#181818" points="365.5,350.6563,355.5,354.6563,365.5,358.6563,361.5,354.6563" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="361.5" y="336.5903">Update household individual</text><polygon fill="#181818" points="602.5,379.7891,612.5,383.7891,602.5,387.7891,606.5,383.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="608.5" y1="383.7891" y2="383.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="361.5" y="378.7231">Update individual</text><polygon fill="#181818" points="829.5,408.9219,839.5,412.9219,829.5,416.9219,833.5,412.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="614.5" x2="835.5" y1="412.9219" y2="412.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="621.5" y="407.856">(async) Produce Individual Data</text><polygon fill="#181818" points="852.5,438.0547,842.5,442.0547,852.5,446.0547,848.5,442.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="846.5" x2="1148.5" y1="442.0547" y2="442.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="858.5" y="436.9888">(async) Consume Individual Data</text><polygon fill="#181818" points="852.5,467.1875,842.5,471.1875,852.5,475.1875,848.5,471.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="846.5" x2="1231.5" y1="471.1875" y2="471.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="858.5" y="466.1216">(async) Consume Individual Data</text><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="396.5" y1="500.3203" y2="500.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="396.5" y1="500.3203" y2="513.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="396.5" y1="513.3203" y2="513.3203"/><polygon fill="#181818" points="365.5,509.3203,355.5,513.3203,365.5,517.3203,361.5,513.3203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="361.5" y="495.2544">Update Household Individual mapping</text><polygon fill="#181818" points="829.5,538.4531,839.5,542.4531,829.5,546.4531,833.5,542.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="835.5" y1="542.4531" y2="542.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333" x="361.5" y="537.3872">(async) Produce Household-Individual mapping data</text><polygon fill="#181818" points="852.5,567.5859,842.5,571.5859,852.5,575.5859,848.5,571.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="846.5" x2="1148.5" y1="571.5859" y2="571.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284" x="858.5" y="566.52">(async) Consume Household-Individual Data</text><polygon fill="#181818" points="852.5,596.7188,842.5,600.7188,852.5,604.7188,848.5,600.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="846.5" x2="1231.5" y1="600.7188" y2="600.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284" x="858.5" y="595.6528">(async) Consume Household-Individual Data</text><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="396.5" y1="636.8516" y2="636.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="396.5" y1="636.8516" y2="649.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="396.5" y1="649.8516" y2="649.8516"/><polygon fill="#181818" points="365.5,645.8516,355.5,649.8516,365.5,653.8516,361.5,649.8516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="361.5" y="631.7856">Fetch household</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="354.5" y1="678.9844" y2="678.9844"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="312.5" y1="678.9844" y2="691.9844"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="353.5" y1="691.9844" y2="691.9844"/><polygon fill="#181818" points="345.5,687.9844,355.5,691.9844,345.5,695.9844,349.5,691.9844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="287.5" y="673.9185">Household</text><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="396.5" y1="721.1172" y2="721.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="396.5" x2="396.5" y1="721.1172" y2="734.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="355.5" x2="396.5" y1="734.1172" y2="734.1172"/><polygon fill="#181818" points="365.5,730.1172,355.5,734.1172,365.5,738.1172,361.5,734.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="361.5" y="716.0513">Update household</text><polygon fill="#181818" points="829.5,759.25,839.5,763.25,829.5,767.25,833.5,763.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="354.5" x2="835.5" y1="763.25" y2="763.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="361.5" y="758.1841">(async) Produce Household Data</text><polygon fill="#181818" points="852.5,788.3828,842.5,792.3828,852.5,796.3828,848.5,792.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="846.5" x2="1148.5" y1="792.3828" y2="792.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="858.5" y="787.3169">(async) Consume Household Data</text><polygon fill="#181818" points="852.5,817.5156,842.5,821.5156,852.5,825.5156,848.5,821.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="846.5" x2="1231.5" y1="821.5156" y2="821.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="858.5" y="816.4497">(async) Consume Household Data</text><polygon fill="#181818" points="44.5,861.7813,34.5,865.7813,44.5,869.7813,40.5,865.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38.5" x2="348.5" y1="865.7813" y2="865.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="50.5" y="845.5825">HTTP Status OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="50.5" y="860.7153">Return Payload with householdRegistrationId</text><!--MD5=[4c4933f9e6d57d0889dc075861390671]
@startuml
title Update Household

Client->HouseholdRegistry ++:Update Household
HouseholdRegistry->HouseholdRegistry: Validate\nRequest
opt
HouseholdRegistry->HouseholdRegistry: Individual data changed?
HouseholdRegistry->HouseholdRegistry: Fetch individual(s) to update
HouseholdRegistry<- -HouseholdRegistry: Individual(s)
HouseholdRegistry->HouseholdRegistry: Update household individual
HouseholdRegistry->IndividualRegistry: Update individual
IndividualRegistry->Kafka: (async) Produce Individual Data
Kafka<-Persister: (async) Consume Individual Data
Kafka<-Indexer: (async) Consume Individual Data
HouseholdRegistry->HouseholdRegistry: Update Household Individual mapping
HouseholdRegistry->Kafka: (async) Produce Household-Individual mapping data
Kafka<-Persister: (async) Consume Household-Individual Data
Kafka<-Indexer: (async) Consume Household-Individual Data
end
HouseholdRegistry->HouseholdRegistry: Fetch household
HouseholdRegistry<- -HouseholdRegistry: Household
HouseholdRegistry->HouseholdRegistry: Update household
HouseholdRegistry->Kafka: (async) Produce Household Data
Kafka<-Persister: (async) Consume Household Data
Kafka<-Indexer: (async) Consume Household Data
HouseholdRegistry->Client - -: HTTP Status OK\nReturn Payload with householdRegistrationId
@enduml

PlantUML version 1.2022.8beta8(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>