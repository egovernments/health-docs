<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1107px" preserveAspectRatio="none" style="width:1233px;height:1107px;background:#FFFFFF;" version="1.1" viewBox="0 0 1233 1107" width="1233px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="912.7188" style="stroke:#696969;stroke-width:1.0;" width="10" x="649.5" y="98.4297"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1069.5" y="368.4922"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1069.5" y="551.2891"/><rect fill="#FFFFFF" height="30" style="stroke:#696969;stroke-width:1.0;" width="10" x="1069.5" y="667.8203"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1069.5" y="763.0859"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1165" y="426.7578"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1165" y="609.5547"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1165" y="852.4844"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1165" y="952.8828"/><rect fill="none" height="94.3984" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="827.5" x="9" y="155.5625"/><rect fill="none" height="494.125" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="1174" x="53" y="306.0938"/><rect fill="none" height="168.7969" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="1154" x="63" y="330.2266"/><rect fill="none" height="221.9297" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="938" x="279" y="513.0234"/><rect fill="none" height="110.5313" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="1154" x="63" y="814.2188"/><line style="stroke:#696969;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="317" x2="317" y1="67.2969" y2="1029.1484"/><line style="stroke:#696969;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="654.5" x2="654.5" y1="67.2969" y2="1029.1484"/><line style="stroke:#696969;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1074" x2="1074" y1="67.2969" y2="1029.1484"/><line style="stroke:#696969;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1170" x2="1170" y1="67.2969" y2="1029.1484"/><rect fill="#FF6347" height="30.2969" rx="3.5" ry="3.5" style="stroke:#454645;stroke-width:1.5;" width="57" x="289" y="36"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="296" y="55.9951">Client</text><rect fill="#FF6347" height="30.2969" rx="3.5" ry="3.5" style="stroke:#454645;stroke-width:1.5;" width="57" x="289" y="1028.1484"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="296" y="1048.1436">Client</text><rect fill="#FF6347" height="30.2969" rx="3.5" ry="3.5" style="stroke:#454645;stroke-width:1.5;" width="148" x="580.5" y="36"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="587.5" y="55.9951">HouseholdRegistry</text><rect fill="#FF6347" height="30.2969" rx="3.5" ry="3.5" style="stroke:#454645;stroke-width:1.5;" width="148" x="580.5" y="1028.1484"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134" x="587.5" y="1048.1436">HouseholdRegistry</text><rect fill="#FF6347" height="30.2969" rx="3.5" ry="3.5" style="stroke:#454645;stroke-width:1.5;" width="97" x="1026" y="36"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="1033" y="55.9951">RedisCache</text><rect fill="#FF6347" height="30.2969" rx="3.5" ry="3.5" style="stroke:#454645;stroke-width:1.5;" width="97" x="1026" y="1028.1484"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="1033" y="1048.1436">RedisCache</text><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="1133" y="63.9951">Database</text><path d="M1152,15 C1152,5 1170,5 1170,5 C1170,5 1188,5 1188,15 L1188,41 C1188,51 1170,51 1170,51 C1170,51 1152,51 1152,41 L1152,15 " fill="#00FFFF" style="stroke:#454645;stroke-width:1.5;"/><path d="M1152,15 C1152,25 1170,25 1170,25 C1170,25 1188,25 1188,15 " fill="none" style="stroke:#454645;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="1133" y="1041.1436">Database</text><path d="M1152,1054.4453 C1152,1044.4453 1170,1044.4453 1170,1044.4453 C1170,1044.4453 1188,1044.4453 1188,1054.4453 L1188,1080.4453 C1188,1090.4453 1170,1090.4453 1170,1090.4453 C1170,1090.4453 1152,1090.4453 1152,1080.4453 L1152,1054.4453 " fill="#00FFFF" style="stroke:#454645;stroke-width:1.5;"/><path d="M1152,1054.4453 C1152,1064.4453 1170,1064.4453 1170,1064.4453 C1170,1064.4453 1188,1064.4453 1188,1054.4453 " fill="none" style="stroke:#454645;stroke-width:1.5;"/><rect fill="#FFFFFF" height="912.7188" style="stroke:#696969;stroke-width:1.0;" width="10" x="649.5" y="98.4297"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1069.5" y="368.4922"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1069.5" y="551.2891"/><rect fill="#FFFFFF" height="30" style="stroke:#696969;stroke-width:1.0;" width="10" x="1069.5" y="667.8203"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1069.5" y="763.0859"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1165" y="426.7578"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1165" y="609.5547"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1165" y="852.4844"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#696969;stroke-width:1.0;" width="10" x="1165" y="952.8828"/><polygon fill="#454645" points="637.5,94.4297,647.5,98.4297,637.5,102.4297,641.5,98.4297" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="317.5" x2="643.5" y1="98.4297" y2="98.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="324.5" y="93.3638">/household/v1/_search</text><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="701.5" y1="127.5625" y2="127.5625"/><line style="stroke:#454645;stroke-width:1.0;" x1="701.5" x2="701.5" y1="127.5625" y2="140.5625"/><line style="stroke:#454645;stroke-width:1.0;" x1="660.5" x2="701.5" y1="140.5625" y2="140.5625"/><polygon fill="#454645" points="670.5,136.5625,660.5,140.5625,670.5,144.5625,666.5,140.5625" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="666.5" y="122.4966">Validate request body</text><path d="M12.5,155.5625 L75,155.5625 L75,162.6953 L65,172.6953 L9,172.6953 L9,159.0625 A3.5,3.5 0 0 1 12.5,155.5625 " fill="#EEEEEE" style="stroke:#696969;stroke-width:1.5;"/><rect fill="none" height="94.3984" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="827.5" x="9" y="155.5625"/><text fill="#454645" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="24" y="168.6294">alt</text><text fill="#696969" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="167" x="90" y="167.7729">[request validation fails]</text><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="701.5" y1="193.8281" y2="193.8281"/><line style="stroke:#454645;stroke-width:1.0;" x1="701.5" x2="701.5" y1="193.8281" y2="206.8281"/><line style="stroke:#454645;stroke-width:1.0;" x1="660.5" x2="701.5" y1="206.8281" y2="206.8281"/><polygon fill="#454645" points="670.5,202.8281,660.5,206.8281,670.5,210.8281,666.5,206.8281" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="666.5" y="188.7622">Request validation failed</text><polygon fill="#454645" points="328.5,234.9609,318.5,238.9609,328.5,242.9609,324.5,238.9609" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="322.5" x2="648.5" y1="238.9609" y2="238.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280" x="334.5" y="233.895">HttpStatus: 400 with appropriate error code</text><path d="M19,223.3281 L19,241.3281 A3.5,3.5 0 0 0 22.5,244.8281 L308.5,244.8281 A3.5,3.5 0 0 0 312,241.3281 L312,229.8281 L302,219.8281 L22.5,219.8281 A3.5,3.5 0 0 0 19,223.3281 " fill="#7FFFD4" style="stroke:#181818;stroke-width:1.5;"/><path d="M302,219.8281 L302,228.0781 A1.75,1.75 0 0 0 303.75,229.8281 L312,229.8281 L302,219.8281 " fill="#7FFFD4" style="stroke:#181818;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="25" y="236.895">Error Code: REQUEST_VALIDATION_FAILED</text><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="701.5" y1="278.0938" y2="278.0938"/><line style="stroke:#454645;stroke-width:1.0;" x1="701.5" x2="701.5" y1="278.0938" y2="291.0938"/><line style="stroke:#454645;stroke-width:1.0;" x1="660.5" x2="701.5" y1="291.0938" y2="291.0938"/><polygon fill="#454645" points="670.5,287.0938,660.5,291.0938,670.5,295.0938,666.5,291.0938" style="stroke:#454645;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="666.5" y="273.0278">Request validation successful</text><path d="M56.5,306.0938 L119,306.0938 L119,313.2266 L109,323.2266 L53,323.2266 L53,309.5938 A3.5,3.5 0 0 1 56.5,306.0938 " fill="#EEEEEE" style="stroke:#696969;stroke-width:1.5;"/><rect fill="none" height="494.125" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="1174" x="53" y="306.0938"/><text fill="#454645" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="68" y="319.1606">alt</text><text fill="#696969" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="324" x="134" y="318.3042">[search by clientReferenceId/serverGeneratedId]</text><path d="M66.5,330.2266 L129,330.2266 L129,337.3594 L119,347.3594 L63,347.3594 L63,333.7266 A3.5,3.5 0 0 1 66.5,330.2266 " fill="#EEEEEE" style="stroke:#696969;stroke-width:1.5;"/><rect fill="none" height="168.7969" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="1154" x="63" y="330.2266"/><text fill="#454645" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="78" y="343.2935">alt</text><text fill="#696969" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="145" x="144" y="342.437">[record doesn't exist]</text><polygon fill="#454645" points="1057.5,364.4922,1067.5,368.4922,1057.5,372.4922,1061.5,368.4922" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="1063.5" y1="368.4922" y2="368.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="666.5" y="363.4263">Search record based on clientReferenceId/serverGeneratedId</text><polygon fill="#454645" points="670.5,393.625,660.5,397.625,670.5,401.625,666.5,397.625" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="664.5" x2="1073.5" y1="397.625" y2="397.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="676.5" y="392.5591">0 rows</text><polygon fill="#454645" points="1153,422.7578,1163,426.7578,1153,430.7578,1157,426.7578" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="1159" y1="426.7578" y2="426.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="666.5" y="421.6919">Search record based on clientReferenceId/serverGeneratedId</text><polygon fill="#454645" points="670.5,451.8906,660.5,455.8906,670.5,459.8906,666.5,455.8906" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="664.5" x2="1169" y1="455.8906" y2="455.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="676.5" y="450.8247">0 rows</text><polygon fill="#454645" points="328.5,484.0234,318.5,488.0234,328.5,492.0234,324.5,488.0234" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="322.5" x2="648.5" y1="488.0234" y2="488.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280" x="334.5" y="482.9575">HttpStatus: 400 with appropriate error code</text><path d="M73,472.3906 L73,490.3906 A3.5,3.5 0 0 0 76.5,493.8906 L308.5,493.8906 A3.5,3.5 0 0 0 312,490.3906 L312,478.8906 L302,468.8906 L76.5,468.8906 A3.5,3.5 0 0 0 73,472.3906 " fill="#7FFFD4" style="stroke:#181818;stroke-width:1.5;"/><path d="M302,468.8906 L302,477.1406 A1.75,1.75 0 0 0 303.75,478.8906 L312,478.8906 L302,468.8906 " fill="#7FFFD4" style="stroke:#181818;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="79" y="485.9575">Error Code: RECORD_NOT_FOUND</text><path d="M282.5,513.0234 L345,513.0234 L345,520.1563 L335,530.1563 L279,530.1563 L279,516.5234 A3.5,3.5 0 0 1 282.5,513.0234 " fill="#EEEEEE" style="stroke:#696969;stroke-width:1.5;"/><rect fill="none" height="221.9297" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="938" x="279" y="513.0234"/><text fill="#454645" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="294" y="526.0903">alt</text><text fill="#696969" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="210" x="360" y="525.2339">[record doesn't exists in cache]</text><polygon fill="#454645" points="1057.5,547.2891,1067.5,551.2891,1057.5,555.2891,1061.5,551.2891" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="1063.5" y1="551.2891" y2="551.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="666.5" y="546.2231">Search record based on clientReferenceId/serverGeneratedId</text><polygon fill="#454645" points="670.5,576.4219,660.5,580.4219,670.5,584.4219,666.5,580.4219" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="664.5" x2="1073.5" y1="580.4219" y2="580.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="676.5" y="575.356">0 rows</text><polygon fill="#454645" points="1153,605.5547,1163,609.5547,1153,613.5547,1157,609.5547" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="1159" y1="609.5547" y2="609.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="666.5" y="604.4888">Search record based on clientReferenceId/serverGeneratedId</text><polygon fill="#454645" points="670.5,634.6875,660.5,638.6875,670.5,642.6875,666.5,638.6875" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="664.5" x2="1169" y1="638.6875" y2="638.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="676.5" y="633.6216">1 row</text><polygon fill="#454645" points="1057.5,663.8203,1067.5,667.8203,1057.5,671.8203,1061.5,667.8203" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="1063.5" y1="667.8203" y2="667.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="666.5" y="662.7544">1 record</text><polygon fill="#454645" points="328.5,722.9531,318.5,726.9531,328.5,730.9531,324.5,726.9531" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="322.5" x2="648.5" y1="726.9531" y2="726.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="334.5" y="721.8872">HttpStatus: 200 with appropriate response code</text><polygon fill="#454645" points="1057.5,759.0859,1067.5,763.0859,1057.5,767.0859,1061.5,763.0859" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="1063.5" y1="763.0859" y2="763.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="666.5" y="758.02">Search record based on clientReferenceId/serverGeneratedId</text><polygon fill="#454645" points="670.5,788.2188,660.5,792.2188,670.5,796.2188,666.5,792.2188" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="664.5" x2="1073.5" y1="792.2188" y2="792.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="676.5" y="787.1528">1 row</text><path d="M66.5,814.2188 L129,814.2188 L129,821.3516 L119,831.3516 L63,831.3516 L63,817.7188 A3.5,3.5 0 0 1 66.5,814.2188 " fill="#EEEEEE" style="stroke:#696969;stroke-width:1.5;"/><rect fill="none" height="110.5313" rx="3.5" ry="3.5" style="stroke:#696969;stroke-width:1.0;" width="1154" x="63" y="814.2188"/><text fill="#454645" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="78" y="827.2856">alt</text><text fill="#696969" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="225" x="144" y="826.4292">[record doesn't exist for criteria]</text><polygon fill="#454645" points="1153,848.4844,1163,852.4844,1153,856.4844,1157,852.4844" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="1159" y1="852.4844" y2="852.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="666.5" y="847.4185">Search record based on criteria</text><polygon fill="#454645" points="670.5,877.6172,660.5,881.6172,670.5,885.6172,666.5,881.6172" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="664.5" x2="1169" y1="881.6172" y2="881.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="676.5" y="876.5513">0 rows</text><polygon fill="#454645" points="328.5,909.75,318.5,913.75,328.5,917.75,324.5,913.75" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="322.5" x2="648.5" y1="913.75" y2="913.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280" x="334.5" y="908.6841">HttpStatus: 400 with appropriate error code</text><path d="M73,898.1172 L73,916.1172 A3.5,3.5 0 0 0 76.5,919.6172 L308.5,919.6172 A3.5,3.5 0 0 0 312,916.1172 L312,904.6172 L302,894.6172 L76.5,894.6172 A3.5,3.5 0 0 0 73,898.1172 " fill="#7FFFD4" style="stroke:#181818;stroke-width:1.5;"/><path d="M302,894.6172 L302,902.8672 A1.75,1.75 0 0 0 303.75,904.6172 L312,904.6172 L302,894.6172 " fill="#7FFFD4" style="stroke:#181818;stroke-width:1.5;"/><text fill="#454645" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="79" y="911.6841">Error Code: RECORD_NOT_FOUND</text><polygon fill="#454645" points="1153,948.8828,1163,952.8828,1153,956.8828,1157,952.8828" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="659.5" x2="1159" y1="952.8828" y2="952.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="666.5" y="947.8169">Search record based on criteria</text><polygon fill="#454645" points="670.5,978.0156,660.5,982.0156,670.5,986.0156,666.5,982.0156" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="664.5" x2="1169" y1="982.0156" y2="982.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="676.5" y="976.9497">1-n rows</text><polygon fill="#454645" points="328.5,1007.1484,318.5,1011.1484,328.5,1015.1484,324.5,1011.1484" style="stroke:#454645;stroke-width:1.0;"/><line style="stroke:#454645;stroke-width:1.0;" x1="322.5" x2="653.5" y1="1011.1484" y2="1011.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="334.5" y="1006.0825">HttpStatus: 200 OK with found record(s)</text><!--MD5=[1f0dc3bc66dcaa6c817bc55c34c623db]
@startuml
!theme vibrant
participant Client as c
participant HouseholdRegistry as s
participant RedisCache as rc
database Database as db
c -> s : /household/v1/_search
activate s
s -> s: Validate request body
alt request validation fails
    s -> s: Request validation failed
    s -> c: HttpStatus: 400 with appropriate error code
    note left
      Error Code: REQUEST_VALIDATION_FAILED
    end note
end
s -> s: Request validation successful
alt search by clientReferenceId/serverGeneratedId
    alt record doesn't exist
        s -> rc: Search record based on clientReferenceId/serverGeneratedId
        activate rc
        rc -> s: 0 rows
        deactivate rc
        s -> db: Search record based on clientReferenceId/serverGeneratedId
        activate db
        db -> s: 0 rows
        deactivate db
        s -> c: HttpStatus: 400 with appropriate error code
        note left
          Error Code: RECORD_NOT_FOUND
        end note
    end
    alt record doesn't exists in cache
        s -> rc: Search record based on clientReferenceId/serverGeneratedId
        activate rc
        rc -> s: 0 rows
        deactivate rc
        s -> db: Search record based on clientReferenceId/serverGeneratedId
        activate db
        db -> s: 1 row
        deactivate db
        s -> rc: 1 record
        activate rc
        deactivate rc
        s -> c: HttpStatus: 200 with appropriate response code
    end
s -> rc: Search record based on clientReferenceId/serverGeneratedId
activate rc
rc -> s: 1 row
deactivate rc
end
alt record doesn't exist for criteria
    s -> db: Search record based on criteria
    activate db
    db -> s: 0 rows
    deactivate db
    s -> c: HttpStatus: 400 with appropriate error code
    note left
      Error Code: RECORD_NOT_FOUND
    end note
end
s -> db: Search record based on criteria
activate db
db -> s: 1-n rows
deactivate db
s -> c: HttpStatus: 200 OK with found record(s)
deactivate s
@enduml

@startuml
skinparam BackgroundColor FFFFFF
skinparam shadowing false
skinparam RoundCorner 7
skinparam ArrowColor 454645
skinparam FontColor 454645
skinparam SequenceLifeLineBorderColor 696969
skinparam SequenceGroupHeaderFontColor 454645
skinparam SequenceGroupFontColor 696969
skinparam SequenceGroupBorderColor 696969
skinparam SequenceGroupBorderThickness 1

skinparam sequenceDivider {
    BorderColor 454645
    BorderThickness 1
    FontColor 454645
}

skinparam participant {
    BackgroundColor FF6347
    BorderColor 454645
    FontColor FFFFFF
    BorderThickness 1.5
}

skinparam database {
    BackgroundColor 00FFFF
    BorderColor 454645
    FontColor 454645
}

skinparam entity {
    BackgroundColor FFE552
    BorderColor 454645
    FontColor 454645
}

skinparam note {
    BackgroundColor 7FFFD4
    BorderColor 454645
    FontColor 454645
    BorderThickness 1.5
}

skinparam actor {
    BackgroundColor 454645
    BorderColor 454645
    FontColor 454645
}

skinparam boundary {
    BackgroundColor FFE552
    BorderColor 454645
    FontColor 454645
}

skinparam control {
    BackgroundColor FFE552
    BorderColor 454645
    FontColor 454645
}

skinparam collections {
    BackgroundColor FF5F42
    BorderColor 454645
    FontColor 454645
}

skinparam queue {
    BackgroundColor FF6347
    BorderColor 454645
    FontColor FFF
    BorderThickness 1.5
}
participant Client as c
participant HouseholdRegistry as s
participant RedisCache as rc
database Database as db
c -> s : /household/v1/_search
activate s
s -> s: Validate request body
alt request validation fails
    s -> s: Request validation failed
    s -> c: HttpStatus: 400 with appropriate error code
    note left
      Error Code: REQUEST_VALIDATION_FAILED
    end note
end
s -> s: Request validation successful
alt search by clientReferenceId/serverGeneratedId
    alt record doesn't exist
        s -> rc: Search record based on clientReferenceId/serverGeneratedId
        activate rc
        rc -> s: 0 rows
        deactivate rc
        s -> db: Search record based on clientReferenceId/serverGeneratedId
        activate db
        db -> s: 0 rows
        deactivate db
        s -> c: HttpStatus: 400 with appropriate error code
        note left
          Error Code: RECORD_NOT_FOUND
        end note
    end
    alt record doesn't exists in cache
        s -> rc: Search record based on clientReferenceId/serverGeneratedId
        activate rc
        rc -> s: 0 rows
        deactivate rc
        s -> db: Search record based on clientReferenceId/serverGeneratedId
        activate db
        db -> s: 1 row
        deactivate db
        s -> rc: 1 record
        activate rc
        deactivate rc
        s -> c: HttpStatus: 200 with appropriate response code
    end
s -> rc: Search record based on clientReferenceId/serverGeneratedId
activate rc
rc -> s: 1 row
deactivate rc
end
alt record doesn't exist for criteria
    s -> db: Search record based on criteria
    activate db
    db -> s: 0 rows
    deactivate db
    s -> c: HttpStatus: 400 with appropriate error code
    note left
      Error Code: RECORD_NOT_FOUND
    end note
end
s -> db: Search record based on criteria
activate db
db -> s: 1-n rows
deactivate db
s -> c: HttpStatus: 200 OK with found record(s)
deactivate s
@enduml

PlantUML version 1.2022.13beta8(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>